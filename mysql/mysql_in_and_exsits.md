# in和exsits

* [Mysql之IN 和 Exists 用法](http://www.cnblogs.com/zhangminghui/p/4403672.html)

## 基本用法

* IN：后面的子查询 是返回结果集的,换句话说执行次序和Exists()不一样.子查询先产生结果集,然后主查询再去结果集里去找符合要求的字段列表去.符合要求的输出,反之则不输出.

* Exists：后面的子查询被称做相关子查询, 他是不返回列表的值的.只是返回一个ture或false的结果(这也是为什么子查询里是 "select   1 "的原因,当然也可以select任何东西) 其运行方式是先运行主查询一次。再去子查询里查询与其对应的结果，如果是ture则输出,反之则不输出.再根据主查询中的每一行去子查询里去查询。

## 运行过程

Exists执行顺序如下： 

1. 首先执行一次外部查询 
2. 对于外部查询中的每一行分别执行一次子查询，而且每次执行子查询时都会引用外部查询中当前行的值。 
3. 使用子查询的结果来确定外部查询的结果集。（如果外部查询返回100行，SQL   就将执行101次查询，一次执行外部查询，然后为外部查询返回的每一行执行一次子查询。但实际上，SQL的查询 优化器有可能会找到一种更好的方法来执行相关子查询，而不需要实际执行101次查询。）

IN的执行过程如下：

1. 首先运行子查询，获取子结果集
2. 主查询再去结果集里去找符合要求的字段列表，.符合要求的输出,反之则不输出。

## 区别

* IN是把外表和内表作hash 连接，
* 而Exists是对外表作loop循环，每次loop循环再对内表进行查询。

	一直以来认为Exists比IN效率高的说法是不准确的。如果查询的两个表大小相当，那么用IN和Exists差别不大。如果两个表中一个较小，一个是大表，则子查询表大的用Exists，子查询表小的用IN
	
## not IN 和not Exists

not IN 和not Exists如果查询语句使用了not in 那么内外表都进行全表扫描，没有用到索引；而not extsts 的子查询依然能用到表上的索引。所以无论那个表大，用not Exists都比not IN要快。

## in 与 = 的区别

`select name from student where name in ('A','S','D','F');`
与
`select name from student where name='A' or name='S' or name='D' or name='F'`
的结果是相同的。
