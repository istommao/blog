# 开发箴言

部分是可能对 `python` 更合适

* 数据库表设计，非必要（强一致性）下，少用外键

 * 便于分库分表
* 在对性能影响不大的情况下(性能要求不要，或者并发不够，或者本身就很快)的情况下，可以不进行 `join`，写成多条查询，通过代码去合并
* 如果某个访问数据库的函数被过多的调用，这个地方可定需要优化，看下是否可以通过 `join` 解决，将循环部分通过 `join` 一次完成，或者通过改写实现方式：实现逻辑或者加缓存
* 尽可能使用 `ORM`，便于测试
* 将多次访问数据库优化为一次访问把所需要的数据全部取回，优化点：减少了网络传输
* ORM 查询数据库可以把所有字段都取回来，保证模型的一致，同时有利于后续做缓存之类的。除非取回所有字段导致结果字节数过多，引起网络延迟太长，这时可以只取回需要的字段
* for 循环里多次被创建（引申：某个函数被多次调用）的变量是否可以复用，如果是：在外层创建好后，在内部不在创建
* 函数长度不易过长，太长写测试比较困难，而且维护困难。
* 少用 `if`, 写出来的代码可能更优雅，bug 更少
* 尽量写 `显示` 的代码，而不是 `隐示`，保证程序在你的预期和控制中。比如函数少用 `*arg` 和 `**kw` 这种不限参数
* mysql 的分页, 不使用 limit 和 offset: <https://www.sitepoint.com/paginating-real-time-data-cursor-based-pagination/>
* 尽量像函数式编程一样，不要在中间过程对一个变量进行修改，保证代码的可预期行。同上两点